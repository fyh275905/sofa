<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>




  
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>Compliant plugin</title>
  

  
  
  <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script></head><body>
<h1 style="text-align: center;">Compliant</h1>

<table style="text-align: left; width: 373px; height: 246px; margin-left: auto; margin-right: auto;" border="1" cellpadding="2" cellspacing="2">

  <tbody>
    <tr align="center">
      <td style="vertical-align: top;">Snapshot of CompliantCloth.scn<br>
      </td>
    </tr>
    <tr align="center">
      <td style="vertical-align: top;"><img style="width: 281px; height: 181px;" alt="representative image of the plugin" src="Compliant.png"></td>
    </tr>
  </tbody>
</table>

<br>

<a href="#Introduction">Introduction</a><br>

<a href="#Examples">Examples</a><br>

<a href="#Project_structure">Project structure</a><br>

<a href="#Intellectual_property_and_rights">Intellectual property and
rights</a><br>

<br>

<h2><a name="Introduction"></a>Introduction</h2>

This plugin introduces a constraint-based approach. Hard constraints
are solved using a classical Delassus operator \( J M^{-1} J^T \),
while soft constraints
are handled by adding compliance to the same operator: \( J M^{-1} J^T
+ C \). More info is given in the <a href="code/html/index.html">code
documentation</a>, which <a href="#Code_documentation_">you can
generate</a> using doxygen.<br>

<br>

This is inspired from <span style="font-style: italic;">Servin,
Lacoursière, Melin, <a href="http://www.ep.liu.se/ecp/019/005/ecp01905.pdf">Interactive
Simulation of Elastic Deformable Materials</a></span>&nbsp; and
generalized in a tunable implicit integration scheme: \[ \begin{array}{ccc} <br>
\Delta v &amp;=&amp; h.M^{-1}.(\alpha
f_{n+1} + (1-\alpha) f_n) \\ <br>
\Delta x &amp;=&amp; h.(\beta v_{n+1} +
(1-\beta) v_n) <br>
\end{array} \] <br>

where  \( M \) is the mass matrix, \( h \) is the time step, \( \alpha \) is the implicit velocity
factor, and \( \beta \) is the implicit position factor.&nbsp;
The corresponding dynamic equation is:
  \[ \left( \begin{array}{cc} <br>\frac{1}{h}PM &amp; -PJ^T \\<br>
&nbsp;J &amp; \frac{1}{l} C \end{array}\right)
      <br>
\left( \begin{array}{c} <br>
\Delta v \\ \bar\lambda <br>
\end{array}\right)
    = \left( \begin{array}{c} <br>Pf_e \\ <br>
- \frac{1}{l} (\phi +(d+\alpha h) \dot \phi)  <br>
\end{array}\right) \]
    <br>where
\( f_e \) is the net external force considered constant across the time
step, \( \phi \) is the constraint violation, \( P \) is a projection
matrix to impose boundary conditions on displacements (typically
maintain fixed points),&nbsp; \( J \) the constraint
Jacobian matrix, \( C \) is the constraint compliance matrix (i.e.
inverse of constraint stiffness), \( l=\alpha(h \beta + d) \) is a term
related to implicit integration and constraint damping, and \(
\bar\lambda \) is the average constraint forces, consistently with the
implicit velocity integration. <br>
<br>
The system is singular due to matrix \( P \), however we can use \( P
M^{-1}P \) as inverse mass matrix to compute Schur complements.<br>
<br>
A Shur complement is used to compute the constraint forces, then these
are added to the external forces to obtain the final velocity
increment, and the positions are updated according to the implicit
scheme: \[ \begin{array}{ccc} <br>
\left( hJPM^{-1}PJ^T + \frac{1}{l}C \right) \bar\lambda &amp;=&amp;
-\frac{1}{l} \left(\phi + (d+h\alpha)\dot\phi \right) - hJ M^{-1} f_e \\ <br>
\Delta v  &amp;=&amp; hP M^{-1}( f_e + J^T \bar\lambda ) \\
                                 <br>
\Delta x  &amp;=&amp;  h( v + \beta \Delta v )
  <br>
\end{array} \]
where \( P \) is the projection matrix corresponding to the projective constraints applied to the independent DOFs.

<br>
More detail on the derivation of this equation in <a href="compliant.pdf">compliant.pdf</a>.<br>
<br>

<br>

<br>

<h2><a name="Examples"></a>Examples</h2>

<ul>

  <li>CompliantTest.scn : a simple pendulum with one particle.</li>
  <li>CompliantCloth.scn&nbsp; : a cloth-like triangle structure<br>
  </li>
</ul>

.<br>

<h2><a name="Project_structure"></a>Project structure</h2>

<ul>

  <li>the C++ code is in the root directory</li>
  <li>the documentation starts in <span style="text-decoration: underline;">doc/index.html</span> and it is
linked to the <a href="code/html/index.html">code documentation</a><br>
  </li>
  
</ul>

<br>

<h2><a name="Intellectual_property_and_rights"></a>Intellectual
property and rights</h2>

<table style="text-align: left; width: 824px; height: 392px;" border="1" cellpadding="2" cellspacing="2">

  <tbody>
    <tr>
      <td style="vertical-align: top;">Authors<br>
      </td>
      <td style="vertical-align: top;">François Faure and...<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Contact<br>
      </td>
      <td style="vertical-align: top;">Francois Faure<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">License<br>
      </td>
      <td style="vertical-align: top;">Your can distribute this plugin
under
the same license as the core of SOFA, or any other license of your
choice.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Patents<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">APP registration<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Sponsors<br>
      </td>
      <td style="vertical-align: top;">No sponsor yet&#8230;&nbsp; :-)<br>
      </td>
    </tr>
  </tbody>
</table>

<br>

<h2>HowTo</h2>

<h4><a name="Code_documentation_"></a>Code documentation </h4>

can be generated using <a href="http://www.stack.nl/%7Edimitri/doxygen/">doxygen</a>. In Unix
systems, simply type <span style="font-family: monospace;">doxygen
Doxyfile</span> in the doc directory.<br>

<br>

<h4><a name="LaTeX_formulas"></a>LaTeX formulas</h4>

can be inserted in this html document thanks to the <a href="http://www.mathjax.org/">mathjax</a> config and
script included in the header. Basically, an inline \( \LaTeX \) formula starts
with <span style="font-weight: bold;">\(</span> and ends with <span style="font-weight: bold;">\)</span>, while a centered formula on a separate line is bracketed using <span style="font-weight: bold;">\[</span> and <span style="font-weight: bold;">\]</span>&nbsp; .<br>

<br>

<br>

<br>

</body></html>
