<?xml version="1.0"?>
<Node 	 name="root"  dt="0.005"  >
	<VisualStyle name="displayFlags"  displayFlags="hideBehaviorModels hideForceFields hideCollisionModels hideMappings" />
	<Gravity name="G"  gravity="10 0 0" />
	<DefaultPipeline name="pipeline"  verbose="0"  depth="6" />
	<BruteForceDetection name="detection" />
	<DefaultContactManager name="response"  response="FrictionContact" />
	<LocalMinDistance name="proximity"  alarmDistance="0.15"  contactDistance="0.05"  angleCone="0" />
	<RequiredPlugin name="Image"  printLog="1"  pluginName="Image" />
	<RequiredPlugin name="Sensable"  printLog="1"  pluginName="Sensable" />
	<RequiredPlugin name="SofaPython"  printLog="1"  pluginName="SofaPython" />
	<!--<RequiredPlugin name="Carving" pluginName="SofaCarving" />-->
	<!--<RequiredPlugin name="OptiTrackNatNet"  printLog="1"  pluginName="OptiTrackNatNet" />-->
	<FreeMotionAnimationLoop name="freeMotionAnimationLoop1" />
	<LCPConstraintSolver name="lCPConstraintSolver1"  group="0" />
	<OglSceneFrame name="oglSceneFrame0"  style="Cylinders"  alignment="BottomRight" />  
	<VisualTransform name="visualTransform0"  transform="0 0 0 0 0 0 0" />
	<!--<CarvingManager active="true"/>-->
	<!--<OptiTrackNatNetClient name="optiTrackNatNetClient1"  listening="1"  serverName="169.254.165.78"  scale="1000"  drawTrackedMarkersSize="0"  drawOtherMarkersSize="2" />-->
	<Node 	 name="cube"  >	
		<EulerImplicitSolver name="eulerImplicitSolver3" />
		<CGLinearSolver template="GraphScattered" name="cGLinearSolver4"  tolerance="1e-009"  threshold="1e-009" />
		
		<MeshObjLoader name="Cubemesh"  filename="mesh/cube.obj"  triangulate="1" scale3d="0.09 1 1"/>
		<MeshToImageEngine template="ImageUC" name="rasterizer"  voxelSize="0.1"  rotateImage="0"  padSize="1"  position="@Cubemesh.position"  edges="@Cubemesh.edges"  triangles="@Cubemesh.triangles"  value="1" />
		<ImageContainer template="ImageUC" name="image"  listening="1"  image="@rasterizer.image"  transform="@rasterizer.transform"  drawBB="0" />
		<ImageViewer template="ImageUC" name="viewer"  image="@image.image"  transform="@image.transform"  display="0" />
		<ImageSampler template="ImageUC" name="sampler"  printLog="1"  listening="1"  image="@image.image"  transform="@image.transform"  method="0 - Regular sampling (at voxel center(0) or corners (1)) "  param="1"  showEdges="1" />
		<!--<ImageExporter template="ImageUC" filename="mesh/cube.obj"  name="imageExporter0"  listening="1" exportAtBegin="1"/>-->
		<!--
		<ImageContainer template="ImageB" name="image"  listening="1"  filename="mesh/cube.obj"  drawBB="0" />
		<ImageViewer template="ImageB" name="viewer"  image="@image.image"  transform="@image.transform"  display="0" />
		<ImageUCilter filter="1"  param="5"  name="gaussianFilter" src="@image" />
		<MarchingCubesEngine name="engine" image="@gaussianFilter.outputImage" transform="@gaussianFilter.outputTransform"  isoValue="50" subdiv="50 50 50" showMesh="true"/>
		-->
		<!--<OptiTrackNatNetDevice name="cubeDevice"  printLog="1"  listening="1"  trackableName="head"  trackableID="1"  isGlobalFrame="1"  inMarkersMeshFile="./meshs/markers-Grab.obj"  simMarkersMeshFile="./meshs/markers-Head.obj"  drawAxisSize="50 10 50"  drawMarkersSize="2"  drawMarkersColor="0 1 0 1" />-->
		<!--
		<Node 	 name="VisualModel"  >
			<OglModel template="ExtVec3f" name="cubeVisualModel"  fileMesh="mesh/cube.obj"  translation="0 0 0"  rotation="0 0 0"  material="Default Diffuse 1 1 1 1 1 Ambient 1 0.2 0.2 0.2 1 Specular 0 1 1 1 1 Emissive 0 1 1 1 1 Shininess 0 45 "  primitiveType="DEFAULT"  blendEquation="GL_FUNC_ADD"  sfactor="GL_SRC_ALPHA"  dfactor="GL_ONE_MINUS_SRC_ALPHA" />
			<BarycentricMapping template="Vec3d,ExtVec3f" name="barycentricMap6"  input="@../CubeState"  output="@./cubeVisualModel" />
		</Node>
		-->
		<Node 	 name="CollisionModel"  >
			<MeshObjLoader name="Curvedloader"  filename="mesh/cube.obj" />
			<MechanicalObject template="Vec3d" name="cubeCollisionState"  tags="CarvingSurface"  position="@Curvedloader.position"  velocity="0 0 0"  force="0 0 0"  externalForce="0 0 0"  restScale="1"  translation="@Curvedloader.position"  rotation="@Curvedloader.rotation"  scale3d="@Curvedloader.scale3d" />
			<MeshTopology name="cubeVisualModel"  position="@Curvedloader.position"  edges="@Curvedloader.edges"  triangles="@Curvedloader.triangles"  quads="@Curvedloader.quads"  tetrahedra="@Curvedloader.tetras"  hexahedra="@Curvedloader.hexas" />
			<!--
			<TetrahedronSetTopologyContainer name="TSTC"  fileTopology="mesh/cube.obj" tetrahedra="@Curvedloader.tetrahedra" />
			<TetrahedronSetTopologyAlgorithms name="TSTA" />
			<TetrahedronSetTopologyModifier name="TSTM"  removeIsolated="1"/>
			<TetrahedronSetGeometryAlgorithms name="TSGA"/> 
			<TetrahedronFEMForceField name="CFEM" youngModulus="360" poissonRatio="0.3" method="large" />
			-->
			<TTriangleModel template="Vec3d" name="CTM"  moving="0"  simulated="0"  contactStiffness="100" />
			<TLineModel template="Vec3d" name="CLM"  moving="0"  simulated="0"  contactStiffness="100" />
			<TPointModel template="Vec3d" name="CPM"  moving="0"  simulated="0"  contactStiffness="100" />
			<IdentityMapping template="Vec3d,Vec3d" name="barycentricMap6"  input="@../CubeState"  output="@./cubeCollisionState" />
		</Node>
	</Node>
	<Node 	 name="Omni"  >
		<NewOmniDriver name="omniDriver1"  listening="1"  scale="50"  positionBase="0 0 0"  orientationBase="0.707 0 0 0.707"  omniVisu="0" />
		<MechanicalObject template="Rigid3d" name="DOFs"  position="0 0 0 0 0 0 1"  velocity="0 0 0 0 0 0"  force="0 0 0 0 0 0"  externalForce="0 0 0 0 0 0"  restScale="1" />
		<MechanicalStateControllerOmni template="Rigid3d" name="MSCO"  listening="1"  handleEventTriggersUpdate="1" />
		<!--<PythonScriptController name="pythonScriptController0"  listening="1"  filename="C:/Users/SOFA_GPU/Desktop/SkullOperations/getPoints.py"  classname="CollisionPoints" />-->
		<Node 	 name="RefModel"  >
			<MeshObjLoader name="loader"  filename="mesh/dental_instrument_centered.obj"  materials="initialShadingGroup.002 Diffuse 1 0.4096 0.4096 0.4096 1 Ambient 1 0 0 0 1 Specular 1 0.5 0.5 0.5 1 Emissive 0 0 0 0 0 Shininess 1 90.1961 " />
			<MeshTopology name="meshTopology1"  position="@loader.position"  edges="@loader.edges"  triangles="@loader.triangles"  quads="@loader.quads"  tetrahedra="@loader.tetras"  hexahedra="@loader.hexas" />
			<MechanicalObject template="Vec3d" name="instrumentCollisionState"  position="@loader.position"  velocity="0 0 0"  force="0 0 0"  externalForce="0 0 0"  restScale="1"  translation="-0.3 0 3.5"  rotation="0 -180 -90" />
			
			<RigidMapping template="Rigid3d,Vec3d" name="rigidMap2"  input="@../"  output="@./" />
		</Node>
	</Node>
	<Node 	 name="Instrument"  >
		<EulerImplicitSolver name="ODE solver"  rayleighStiffness="0.05"  rayleighMass="1" />
		<CGLinearSolver template="GraphScattered" name="linear solver"  iterations="25"  tolerance="1e-005"  threshold="1e-005" />
		<MechanicalObject template="Rigid3d" name="instrumentState"  position="0 0 0 0 0 0 1"  velocity="0 0 0 0 0 0"  force="0 0 0 0 0 0"  externalForce="0 0 0 0 0 0"  restScale="1" />
		<UniformMass template="Rigid3d" name="mass"  totalmass="0.05" />
		<LCPForceFeedback template="Rigid3d" name="lCPForceFeedback1"  tags="omni"  listening="1"  activate="1"  forceCoef="0.001" />
		<UncoupledConstraintCorrection template="Rigid3d" name="uncoupledConstraintCorrection1" />
		<Node 	 name="VisualModel"  >
			<OglModel template="ExtVec3f" name="InstrumentVisualModel"  fileMesh="mesh/dental_instrument_centered.obj"  translation="-0.3 0 3.5"  rotation="0 -180 -90"  material="Default Diffuse 1 1 0.2 0.2 1 Ambient 1 0.2 0.04 0.04 1 Specular 0 1 0.2 0.2 1 Emissive 0 1 0.2 0.2 1 Shininess 0 45 "  primitiveType="DEFAULT"  blendEquation="GL_FUNC_ADD"  sfactor="GL_SRC_ALPHA"  dfactor="GL_ONE_MINUS_SRC_ALPHA" />
			<RigidMapping template="Rigid3d,ExtVec3f" name="MM-&gt;VM mapping"  input="@instrumentState"  output="@InstrumentVisualModel" />
		</Node>
		<Node 	 name="CollisionModel"  >
			<MeshObjLoader name="loader"  filename="mesh/dental_instrument_centered.obj"  materials="initialShadingGroup.002 Diffuse 1 0.4096 0.4096 0.4096 1 Ambient 1 0 0 0 1 Specular 1 0.5 0.5 0.5 1 Emissive 0 0 0 0 0 Shininess 1 90.1961 " />
			<MeshTopology name="InstrumentCollisionModel"  position="@loader.position"  edges="@loader.edges"  triangles="@loader.triangles"  quads="@loader.quads"  tetrahedra="@loader.tetras"  hexahedra="@loader.hexas" />
			<MechanicalObject template="Vec3d" name="instrumentCollisionState"  position="@loader.position"  velocity="0 0 0"  force="0 0 0"  externalForce="0 0 0"  restScale="1"  translation="-0.3 0 3.5"  rotation="0 -180 -90" />
			<TLineModel template="Vec3d" name="instrument"  tags="CarvingTool"  contactStiffness="10" />
			<TPointModel template="Vec3d" name="instrument"  tags="CarvingTool"  contactStiffness="10" />
			<RigidMapping template="Rigid3d,Vec3d" name="MM-&gt;CM mapping"  input="@instrumentState"  output="@instrumentCollisionState" />
		</Node>
		<VectorSpringForceField template="Vec3d" name="vectorSpringFF1"  stiffness="10"  viscosity="0"  object1="@Omni/RefModel/instrumentCollisionState"  object2="@Instrument/CollisionModel/instrumentCollisionState" />
	</Node>
</Node>
